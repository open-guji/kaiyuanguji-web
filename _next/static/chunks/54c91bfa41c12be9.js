(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},85130,89271,e=>{"use strict";var t,r=((t={}).WORK="work",t.COLLECTION="collection",t.BOOK="book",t);e.s(["BookResourceType",()=>r],89271);var a=e.i(85149);let o={};async function n(e,t){try{let a=await fetch(e,{cache:"no-store",signal:AbortSignal.timeout(5e3)});if(!a.ok)throw Error(`Failed to fetch from ${e}: ${a.statusText}`);let o=await a.json(),n=[],i=(e,r)=>{e&&Object.values(e).forEach(e=>{n.push({id:e.id,name:e.title||e.name,type:r,isDraft:t,rawPath:e.path,author:e.author,collection:e.collection,year:e.year,holder:e.holder})})};return i(o.books,r.BOOK),i(o.collections,r.COLLECTION),i(o.works,r.WORK),n}catch(e){throw e}}async function i(e="github"){if(o[e])return o[e];let t=[],r=async t=>{if("github"===e)return n(t?a.GITHUB_BOOK_INDEX_DRAFT:a.GITHUB_BOOK_INDEX,t);let r=t?"book-index-draft":"book-index",o="main",i=`${a.JSDELIVR_FASTLY}/${a.GITHUB_ORG}/${r}@${o}/index.json`,l=`${a.JSDELIVR_CDN}/${a.GITHUB_ORG}/${r}@${o}/index.json`;try{return await n(i,t)}catch(e){return console.warn("Fastly index fetch failed, trying fallback:",e),await n(l,t)}};try{let e=await r(!0);t.push(...e)}catch(t){console.warn(`Failed to fetch draft index from ${e}:`,t)}try{let e=await r(!1);t.push(...e)}catch(t){console.warn(`Failed to fetch official index from ${e}:`,t)}let l=new Map;t.forEach(e=>{l.set(e.id,e)});let c=Array.from(l.values());return o[e]=c,c}async function l(e,t="github"){return(await i(t)).find(t=>t.id===e)||null}async function c(e,t="github"){if("github"===t){let r=e.isDraft?`${a.GITHUB_BASE}/${a.GITHUB_ORG}/book-index-draft/main`:`${a.GITHUB_BASE}/${a.GITHUB_ORG}/book-index/main`,o=`${r}/${e.rawPath}`,n=await fetch(o,{cache:"no-store",signal:AbortSignal.timeout(1e4)});if(!n.ok)throw Error(`Failed to fetch book content from ${t}: ${n.statusText}`);return n.text()}let r=e.isDraft?"book-index-draft":"book-index",o="main",n=`${a.JSDELIVR_FASTLY}/${a.GITHUB_ORG}/${r}@${o}/${e.rawPath}`,i=`${a.JSDELIVR_CDN}/${a.GITHUB_ORG}/${r}@${o}/${e.rawPath}`;try{let e=await fetch(n,{cache:"no-store",signal:AbortSignal.timeout(8e3)});if(!e.ok)throw Error(`Fastly status: ${e.status}`);return await e.text()}catch(t){console.warn("Fastly fetch failed, trying fallback CDN:",t);let e=await fetch(i,{cache:"no-store",signal:AbortSignal.timeout(1e4)});if(!e.ok)throw Error(`Failed to fetch book content from CDN: ${e.statusText}`);return await e.text()}}function s(e){switch(e){case r.WORK:return"作品";case r.COLLECTION:return"丛编";case r.BOOK:return"书";default:return""}}function u(e){return e?"草稿":"正式"}e.s(["fetchAllBooks",()=>i,"fetchBookContent",()=>c,"findBookById",()=>l,"getStatusLabel",()=>u,"getTypeLabel",()=>s],85130)},47896,e=>{"use strict";var t=e.i(18050),r=e.i(71645),a=e.i(66073);function o({items:e}){let[a,o]=(0,r.useState)("");return((0,r.useEffect)(()=>{let t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&o(e.target.id)})},{rootMargin:"-20% 0% -35% 0%"});return e.forEach(e=>{let r=document.getElementById(e.id);r&&t.observe(r)}),()=>t.disconnect()},[e]),0===e.length)?null:(0,t.jsxs)("nav",{className:"sticky top-20 max-h-[calc(100vh-6rem)] overflow-y-auto",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-ink mb-3 tracking-wide",children:"目录"}),(0,t.jsx)("ul",{className:"space-y-2 text-sm",children:e.map(e=>(0,t.jsx)("li",{style:{paddingLeft:`${(e.level-1)*.75}rem`},children:(0,t.jsx)("a",{href:`#${e.id}`,onClick:t=>{var r;let a;return r=e.id,t.preventDefault(),void((a=document.getElementById(r))&&a.scrollIntoView({behavior:"smooth",block:"start"}))},className:`
                block py-1 border-l-2 pl-3 transition-colors
                ${a===e.id?"border-vermilion text-vermilion font-medium":"border-transparent text-secondary hover:text-ink hover:border-border"}
              `,children:e.text})},e.id))})]})}function n({content:e,toc:n,title:i}){let l=(0,r.useRef)(null);return(0,r.useEffect)(()=>{l.current&&l.current.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(e=>{let t=(e.textContent||"").toLowerCase().replace(/[^\u4e00-\u9fa5a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");t&&(e.id=t)})},[e]),(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:(0,t.jsxs)("div",{className:"flex gap-8",children:[(0,t.jsxs)("article",{ref:l,className:"flex-1 min-w-0 max-w-3xl mx-auto lg:mx-0",children:[i&&(0,t.jsx)("h1",{className:"text-4xl font-bold text-ink mb-8 tracking-wide",children:i}),(0,t.jsx)(a.default,{content:e})]}),n.length>0&&(0,t.jsx)("aside",{className:"hidden lg:block w-64 flex-shrink-0",children:(0,t.jsx)(o,{items:n})})]})})}e.s(["default",()=>n],47896)}]);